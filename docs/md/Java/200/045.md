# 前言

>  Spring Environment 解析

# Environment

## Environment 定义

Environment 接口是一个集成在容器中的抽象，它对 application environment 的两个关键方面进行建模：配置文件（profiles） 和 属性（properties）。

profile 是一个命名的、逻辑上的 bean 定义组，只有在给定的 profile 处于活动状态时才会在容器中注册。无论是用 XML 定义的还是用注解定义的，Bean 都可以被分配给一个 profile。Environment 对象在 profile 方面的作用是确定哪些 profile（如果有的话）是当前活动（active）的，以及哪些 profile（如果有的话）应该是默认活动的。

属性（Properties）在几乎所有的应用程序中都扮演着重要的角色，它可能来自各种来源：properties 文件、JVM 系统属性、系统环境变量、JNDI、Servlet 上下文参数、特设的 Properties 对象、Map 对象等等。与属性有关的 Environment 对象的作用是为用户提供一个方便的服务接口，用于配置属性源并从它们那里解析属性。

参考文档：
[Spring Environment 抽象定义](https://springdoc.cn/spring/core.html#beans-environment)

## Environment 解析

Spring 容器获取 Environment，代码示例：

```java 
package com.wjs.learn.spring;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.core.env.ConfigurableEnvironment;

public class SpringContextStarter {
    public static void main(String[] args) {

        // 获取 Spring Environment
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext();
        context.refresh();
        ConfigurableEnvironment environment = context.getEnvironment();
    }
}
```
---

Spring 容器中 Environment 清单：

|                                                      |
|------------------------------------------------------|
| org.springframework.core.env.Environment             |
| org.springframework.core.env.ConfigurableEnvironment |
| org.springframework.core.env.AbstractEnvironment     |
| org.springframework.core.env.StandardEnvironment     |


---

Spring 容器中 Environment 继承关系：

```java
org.springframework.core.env.StandardEnvironment
    AbstractEnvironment (org.springframework.core.env)
        ConfigurableEnvironment (org.springframework.core.env)
            Environment (org.springframework.core.env)
                PropertyResolver (org.springframework.core.env)
            ConfigurablePropertyResolver (org.springframework.core.env)
                PropertyResolver (org.springframework.core.env)
```

---

Spring Environment 初始化链路：

> 参考 Spring 版本 5.3.18

```java 
org.springframework.context.annotation.AnnotationConfigApplicationContext#refresh
|
org.springframework.context.support.AbstractApplicationContext#refresh
|
org.springframework.context.support.AbstractApplicationContext#prepareBeanFactory
|
org.springframework.context.support.AbstractApplicationContext#getEnvironment
|
org.springframework.context.support.AbstractApplicationContext#createEnvironment
|
org.springframework.core.env.StandardEnvironment#StandardEnvironment()
|
org.springframework.core.env.AbstractEnvironment#AbstractEnvironment()
|
org.springframework.core.env.AbstractEnvironment#AbstractEnvironment(org.springframework.core.env.MutablePropertySources)
|
org.springframework.core.env.StandardEnvironment#customizePropertySources
```

---

Spring Environment 初始化链路代码清单：

- 1、org.springframework.context.annotation.AnnotationConfigApplicationContext#refresh

```java 
AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext();
context.refresh();
```

- 2、org.springframework.context.support.AbstractApplicationContext#refresh

```java 
public void refresh() throws BeansException, IllegalStateException {
    synchronized (this.startupShutdownMonitor) {
    
        // Tell the subclass to refresh the internal bean factory.
        ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();

        // ConfigurableListableBeanFactory 预处理
        prepareBeanFactory(beanFactory);
    }
}
```

- 3、org.springframework.context.support.AbstractApplicationContext#prepareBeanFactory

```java 
protected void prepareBeanFactory(ConfigurableListableBeanFactory beanFactory) {
    
    // 初始化 Environment
    beanFactory.addPropertyEditorRegistrar(new ResourceEditorRegistrar(this, getEnvironment()));
    
    // 初始化 Environment
    if (!beanFactory.containsLocalBean(ENVIRONMENT_BEAN_NAME)) {
        beanFactory.registerSingleton(ENVIRONMENT_BEAN_NAME, getEnvironment());
    }
    if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {
        beanFactory.registerSingleton(SYSTEM_PROPERTIES_BEAN_NAME, getEnvironment().getSystemProperties());
    }
    if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {
        beanFactory.registerSingleton(SYSTEM_ENVIRONMENT_BEAN_NAME, getEnvironment().getSystemEnvironment());
    }
    if (!beanFactory.containsLocalBean(APPLICATION_STARTUP_BEAN_NAME)) {
        beanFactory.registerSingleton(APPLICATION_STARTUP_BEAN_NAME, getApplicationStartup());
    }
}
```

- 4、org.springframework.context.support.AbstractApplicationContext#getEnvironment

```java 
public ConfigurableEnvironment getEnvironment() {
    if (this.environment == null) {
        // 初始化 Environment
        this.environment = createEnvironment();
    }
    return this.environment;
}
```

- 5、org.springframework.context.support.AbstractApplicationContext#createEnvironment

```java 
protected ConfigurableEnvironment createEnvironment() {
    return new StandardEnvironment();
}
```

- 6、org.springframework.core.env.StandardEnvironment#StandardEnvironment()

```java 
public StandardEnvironment() {
}
```

- 7、org.springframework.core.env.AbstractEnvironment#AbstractEnvironment()

```java 
public AbstractEnvironment() {
    this(new MutablePropertySources());
}
```

- 8、org.springframework.core.env.AbstractEnvironment#AbstractEnvironment(org.springframework.core.env.MutablePropertySources)

```java 
protected AbstractEnvironment(MutablePropertySources propertySources) {
    this.propertySources = propertySources;
    this.propertyResolver = createPropertyResolver(propertySources);
    
    // 初始化 Environment，添加 PropertySource 配置
    customizePropertySources(propertySources);
}
```

- 9、org.springframework.core.env.StandardEnvironment#customizePropertySources

```java 
protected void customizePropertySources(MutablePropertySources propertySources) {
	public static final String SYSTEM_ENVIRONMENT_PROPERTY_SOURCE_NAME = "systemEnvironment";
	public static final String SYSTEM_PROPERTIES_PROPERTY_SOURCE_NAME = "systemProperties";
	
    // JVM 系统属性集合（System.getProperties()）
    propertySources.addLast(new PropertiesPropertySource(SYSTEM_PROPERTIES_PROPERTY_SOURCE_NAME, getSystemProperties()));
    // 系统环境变量集合（System.getenv()）
    propertySources.addLast(new SystemEnvironmentPropertySource(SYSTEM_ENVIRONMENT_PROPERTY_SOURCE_NAME, getSystemEnvironment()));
}
```

---

Spring 容器获取 Environment Bean，代码示例：

- 1、Environment BeanName 常量

```java 
package com.wjs.learn.spring.environment;
import org.springframework.context.ConfigurableApplicationContext;

/**
 * Environment BeanName 常量
 *
 * @author admin
 * @see ConfigurableApplicationContext#ENVIRONMENT_BEAN_NAME
 * @see ConfigurableApplicationContext#SYSTEM_PROPERTIES_BEAN_NAME
 * @see ConfigurableApplicationContext#SYSTEM_ENVIRONMENT_BEAN_NAME
 */
public interface EnvironmentBeanNameConstant {

    // Environment BeanName
    String ENVIRONMENT_BEAN_NAME = "environment";

    // JVM 系统属性集合（System.getProperties()）
    String SYSTEM_PROPERTIES_BEAN_NAME = "systemProperties";

    // 系统环境变量集合（System.getenv()）
    String SYSTEM_ENVIRONMENT_BEAN_NAME = "systemEnvironment";
}
```

- 2、测试

```java 
package com.wjs.learn.spring;
import com.wjs.learn.spring.environment.EnvironmentBeanNameConstant;
import com.wjs.learn.spring.environment.LearningPropertySource;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.core.env.ConfigurableEnvironment;
import org.springframework.core.env.MutablePropertySources;
import org.springframework.core.env.PropertySource;
import java.util.Collections;
import java.util.Map;

public class SpringContextStarter {
    public static void main(String[] args) {

        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext();
        context.refresh();

        // 获取 Spring Environment Bean
        ConfigurableEnvironment configurableEnvironment = context.getBean(EnvironmentBeanNameConstant.ENVIRONMENT_BEAN_NAME, ConfigurableEnvironment.class);
        System.out.println("configurableEnvironment = " + configurableEnvironment);

        // 获取 JVM 系统属性集合（System.getProperties()） Bean
        @SuppressWarnings("unchecked")
        Map<String, Object> systemProperties = context.getBean(EnvironmentBeanNameConstant.SYSTEM_PROPERTIES_BEAN_NAME, Map.class);
        System.out.println("systemProperties = " + systemProperties);

        // 获取 系统环境变量集合（System.getenv()） Bean
        @SuppressWarnings("unchecked")
        Map<String, Object> systemEnvironment = context.getBean(EnvironmentBeanNameConstant.SYSTEM_ENVIRONMENT_BEAN_NAME, Map.class);
        System.out.println("systemEnvironment = " + systemEnvironment);
    }
}
```

- 3、控制台打印

```shell
configurableEnvironment = StandardEnvironment {activeProfiles=[], defaultProfiles=[default], propertySources=[PropertiesPropertySource@402115881 {name='systemProperties', properties={java.runtime.name=Java(TM) SE Runtime Environment, sun.boot.library.path=D:\jdk1.8\jre\bin, java.vm.version=25.202-b08, java.vm.vendor=Oracle Corporation, java.vendor.url=http://java.oracle.com/, path.separator=;, java.vm.name=Java HotSpot(TM) 64-Bit Server VM, file.encoding.pkg=sun.io, user.country=CN, user.script=, sun.java.launcher=SUN_STANDARD, sun.os.patch.level=, java.vm.specification.name=Java Virtual Machine Specification, user.dir=D:\项目\learn-project, intellij.debug.agent=true, java.runtime.version=1.8.0_202-b08, java.awt.graphicsenv=sun.awt.Win32GraphicsEnvironment, java.endorsed.dirs=D:\jdk1.8\jre\lib\endorsed, os.arch=amd64, java.io.tmpdir=C:\Users\admin\AppData\Local\Temp\, line.separator=
, java.vm.specification.vendor=Oracle Corporation, user.variant=, os.name=Windows 10, sun.jnu.encoding=GBK, java.library.path=D:\jdk1.8\bin;C:\WINDOWS\Sun\Java\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\WINDOWS\System32\OpenSSH\;D:\jdk1.8\bin;D:\apache-maven-3.8.6\bin;D:\TortoiseGit\bin;C:\Program Files\MySQL\MySQL Server 8.0\bin;C:\Program Files\dotnet\;D:\Git\cmd;C:\Program Files\MySQL\MySQL Shell 8.0\bin\;%USERPROFILE%\AppData\Local\Microsoft\WindowsApps;%IntelliJ IDEA Community Edition%;%WebStorm%;C:\Users\admin\AppData\Local\UGit\app-5.31.1\resources\app\git\cmd;C:\Users\admin\AppData\Local\UGit\bin;., jboss.modules.system.pkgs=com.intellij.rt, java.specification.name=Java Platform API Specification, java.class.version=52.0, sun.management.compiler=HotSpot 64-Bit Tiered Compilers, os.version=10.0, user.home=C:\Users\admin, user.timezone=Asia/Shanghai, java.awt.printerjob=sun.awt.windows.WPrinterJob, file.encoding=UTF-8, java.specification.version=1.8, java.class.path=D:\jdk1.8\jre\lib\charsets.jar;D:\jdk1.8\jre\lib\deploy.jar;D:\jdk1.8\jre\lib\ext\access-bridge-64.jar;D:\jdk1.8\jre\lib\ext\cldrdata.jar;D:\jdk1.8\jre\lib\ext\dnsns.jar;D:\jdk1.8\jre\lib\ext\jaccess.jar;D:\jdk1.8\jre\lib\ext\jfxrt.jar;D:\jdk1.8\jre\lib\ext\localedata.jar;D:\jdk1.8\jre\lib\ext\nashorn.jar;D:\jdk1.8\jre\lib\ext\sunec.jar;D:\jdk1.8\jre\lib\ext\sunjce_provider.jar;D:\jdk1.8\jre\lib\ext\sunmscapi.jar;D:\jdk1.8\jre\lib\ext\sunpkcs11.jar;D:\jdk1.8\jre\lib\ext\zipfs.jar;D:\jdk1.8\jre\lib\javaws.jar;D:\jdk1.8\jre\lib\jce.jar;D:\jdk1.8\jre\lib\jfr.jar;D:\jdk1.8\jre\lib\jfxswt.jar;D:\jdk1.8\jre\lib\jsse.jar;D:\jdk1.8\jre\lib\management-agent.jar;D:\jdk1.8\jre\lib\plugin.jar;D:\jdk1.8\jre\lib\resources.jar;D:\jdk1.8\jre\lib\rt.jar;D:\项目\learn-project\local-demo\target\classes;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-lang3\3.12.0\commons-lang3-3.12.0.jar;D:\apache-maven-3.8.6\localRepository\commons-io\commons-io\1.3.2\commons-io-1.3.2.jar;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-pool2\2.11.1\commons-pool2-2.11.1.jar;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-math3\3.6.1\commons-math3-3.6.1.jar;D:\apache-maven-3.8.6\localRepository\com\alibaba\fastjson2\fastjson2\2.0.40\fastjson2-2.0.40.jar;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-collections4\4.4\commons-collections4-4.4.jar;D:\apache-maven-3.8.6\localRepository\org\apache\httpcomponents\httpclient\4.5.13\httpclient-4.5.13.jar;D:\apache-maven-3.8.6\localRepository\org\apache\httpcomponents\httpcore\4.4.13\httpcore-4.4.13.jar;D:\apache-maven-3.8.6\localRepository\commons-logging\commons-logging\1.2\commons-logging-1.2.jar;D:\apache-maven-3.8.6\localRepository\commons-codec\commons-codec\1.11\commons-codec-1.11.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-web\2.6.6\spring-boot-starter-web-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter\2.6.6\spring-boot-starter-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot\2.6.6\spring-boot-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-logging\2.6.6\spring-boot-starter-logging-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\ch\qos\logback\logback-classic\1.2.11\logback-classic-1.2.11.jar;D:\apache-maven-3.8.6\localRepository\ch\qos\logback\logback-core\1.2.11\logback-core-1.2.11.jar;D:\apache-maven-3.8.6\localRepository\org\apache\logging\log4j\log4j-to-slf4j\2.17.2\log4j-to-slf4j-2.17.2.jar;D:\apache-maven-3.8.6\localRepository\org\apache\logging\log4j\log4j-api\2.17.2\log4j-api-2.17.2.jar;D:\apache-maven-3.8.6\localRepository\org\slf4j\jul-to-slf4j\1.7.36\jul-to-slf4j-1.7.36.jar;D:\apache-maven-3.8.6\localRepository\jakarta\annotation\jakarta.annotation-api\1.3.5\jakarta.annotation-api-1.3.5.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-core\5.3.18\spring-core-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-jcl\5.3.18\spring-jcl-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\yaml\snakeyaml\1.29\snakeyaml-1.29.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-json\2.6.6\spring-boot-starter-json-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\core\jackson-databind\2.13.2.2\jackson-databind-2.13.2.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\core\jackson-annotations\2.13.2\jackson-annotations-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\core\jackson-core\2.13.2\jackson-core-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\datatype\jackson-datatype-jdk8\2.13.2\jackson-datatype-jdk8-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\datatype\jackson-datatype-jsr310\2.13.2\jackson-datatype-jsr310-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\module\jackson-module-parameter-names\2.13.2\jackson-module-parameter-names-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-tomcat\2.6.6\spring-boot-starter-tomcat-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\apache\tomcat\embed\tomcat-embed-core\9.0.60\tomcat-embed-core-9.0.60.jar;D:\apache-maven-3.8.6\localRepository\org\apache\tomcat\embed\tomcat-embed-el\9.0.60\tomcat-embed-el-9.0.60.jar;D:\apache-maven-3.8.6\localRepository\org\apache\tomcat\embed\tomcat-embed-websocket\9.0.60\tomcat-embed-websocket-9.0.60.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-web\5.3.18\spring-web-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-beans\5.3.18\spring-beans-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-webmvc\5.3.18\spring-webmvc-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-aop\5.3.18\spring-aop-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-context\5.3.18\spring-context-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-expression\5.3.18\spring-expression-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\com\mysql\mysql-connector-j\8.0.33\mysql-connector-j-8.0.33.jar;D:\apache-maven-3.8.6\localRepository\com\google\protobuf\protobuf-java\3.21.9\protobuf-java-3.21.9.jar;D:\apache-maven-3.8.6\localRepository\com\google\guava\guava\25.0-jre\guava-25.0-jre.jar;D:\apache-maven-3.8.6\localRepository\com\google\code\findbugs\jsr305\1.3.9\jsr305-1.3.9.jar;D:\apache-maven-3.8.6\localRepository\org\checkerframework\checker-compat-qual\2.0.0\checker-compat-qual-2.0.0.jar;D:\apache-maven-3.8.6\localRepository\com\google\errorprone\error_prone_annotations\2.1.3\error_prone_annotations-2.1.3.jar;D:\apache-maven-3.8.6\localRepository\com\google\j2objc\j2objc-annotations\1.1\j2objc-annotations-1.1.jar;D:\apache-maven-3.8.6\localRepository\org\codehaus\mojo\animal-sniffer-annotations\1.14\animal-sniffer-annotations-1.14.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-boot-starter\3.5.3.1\mybatis-plus-boot-starter-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus\3.5.3.1\mybatis-plus-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-extension\3.5.3.1\mybatis-plus-extension-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-core\3.5.3.1\mybatis-plus-core-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-annotation\3.5.3.1\mybatis-plus-annotation-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\github\jsqlparser\jsqlparser\4.4\jsqlparser-4.4.jar;D:\apache-maven-3.8.6\localRepository\org\mybatis\mybatis\3.5.10\mybatis-3.5.10.jar;D:\apache-maven-3.8.6\localRepository\org\mybatis\mybatis-spring\2.0.7\mybatis-spring-2.0.7.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-autoconfigure\2.5.3\spring-boot-autoconfigure-2.5.3.jar;D:\apache-maven-3.8.6\localRepository\cn\hutool\hutool-all\5.8.26\hutool-all-5.8.26.jar;D:\apache-maven-3.8.6\localRepository\com\alibaba\druid-spring-boot-starter\1.2.22\druid-spring-boot-starter-1.2.22.jar;D:\apache-maven-3.8.6\localRepository\com\alibaba\druid\1.2.22\druid-1.2.22.jar;D:\apache-maven-3.8.6\localRepository\org\slf4j\slf4j-api\1.7.36\slf4j-api-1.7.36.jar;D:\apache-maven-3.8.6\localRepository\org\glassfish\jaxb\jaxb-runtime\2.3.2\jaxb-runtime-2.3.2.jar;D:\apache-maven-3.8.6\localRepository\jakarta\xml\bind\jakarta.xml.bind-api\2.3.2\jakarta.xml.bind-api-2.3.2.jar;D:\apache-maven-3.8.6\localRepository\org\glassfish\jaxb\txw2\2.3.2\txw2-2.3.2.jar;D:\apache-maven-3.8.6\localRepository\com\sun\istack\istack-commons-runtime\3.0.8\istack-commons-runtime-3.0.8.jar;D:\apache-maven-3.8.6\localRepository\org\jvnet\staxex\stax-ex\1.8.1\stax-ex-1.8.1.jar;D:\apache-maven-3.8.6\localRepository\com\sun\xml\fastinfoset\FastInfoset\1.2.16\FastInfoset-1.2.16.jar;D:\apache-maven-3.8.6\localRepository\jakarta\activation\jakarta.activation-api\1.2.1\jakarta.activation-api-1.2.1.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-starter-openfeign\4.1.0\spring-cloud-starter-openfeign-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-starter\4.1.0\spring-cloud-starter-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-context\4.1.0\spring-cloud-context-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\security\spring-security-rsa\1.1.1\spring-security-rsa-1.1.1.jar;D:\apache-maven-3.8.6\localRepository\org\bouncycastle\bcprov-jdk18on\1.74\bcprov-jdk18on-1.74.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-openfeign-core\4.1.0\spring-cloud-openfeign-core-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-aop\3.2.0\spring-boot-starter-aop-3.2.0.jar;D:\apache-maven-3.8.6\localRepository\org\aspectj\aspectjweaver\1.9.20.1\aspectjweaver-1.9.20.1.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\form\feign-form-spring\3.8.0\feign-form-spring-3.8.0.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\form\feign-form\3.8.0\feign-form-3.8.0.jar;D:\apache-maven-3.8.6\localRepository\commons-fileupload\commons-fileupload\1.5\commons-fileupload-1.5.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-commons\4.1.0\spring-cloud-commons-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\security\spring-security-crypto\6.2.0\spring-security-crypto-6.2.0.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\feign-core\13.1\feign-core-13.1.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\feign-slf4j\13.1\feign-slf4j-13.1.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-jdbc\2.7.9\spring-boot-starter-jdbc-2.7.9.jar;D:\apache-maven-3.8.6\localRepository\com\zaxxer\HikariCP\4.0.3\HikariCP-4.0.3.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-jdbc\5.3.25\spring-jdbc-5.3.25.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-tx\5.3.25\spring-tx-5.3.25.jar;D:\IntelliJ IDEA Community Edition 2023.1.5\lib\idea_rt.jar;C:\Users\admin\AppData\Local\JetBrains\IdeaIC2024.1\captureAgent\debugger-agent.jar, user.name=admin, java.vm.specification.version=1.8, sun.java.command=com.wjs.learn.spring.SpringContextStarter, java.home=D:\jdk1.8\jre, sun.arch.data.model=64, user.language=zh, java.specification.vendor=Oracle Corporation, awt.toolkit=sun.awt.windows.WToolkit, java.vm.info=mixed mode, java.version=1.8.0_202, java.ext.dirs=D:\jdk1.8\jre\lib\ext;C:\WINDOWS\Sun\Java\lib\ext, sun.boot.class.path=D:\jdk1.8\jre\lib\resources.jar;D:\jdk1.8\jre\lib\rt.jar;D:\jdk1.8\jre\lib\sunrsasign.jar;D:\jdk1.8\jre\lib\jsse.jar;D:\jdk1.8\jre\lib\jce.jar;D:\jdk1.8\jre\lib\charsets.jar;D:\jdk1.8\jre\lib\jfr.jar;D:\jdk1.8\jre\classes;C:\Users\admin\AppData\Local\JetBrains\IdeaIC2024.1\captureAgent\debugger-agent.jar, java.vendor=Oracle Corporation, file.separator=\, java.vendor.url.bug=http://bugreport.sun.com/bugreport/, sun.io.unicode.encoding=UnicodeLittle, sun.cpu.endian=little, sun.desktop=windows, sun.cpu.isalist=amd64}}, SystemEnvironmentPropertySource@2106000623 {name='systemEnvironment', properties={USERDOMAIN_ROAMINGPROFILE=柯南剧场版, PROCESSOR_LEVEL=6, SESSIONNAME=Console, ALLUSERSPROFILE=C:\ProgramData, PROCESSOR_ARCHITECTURE=AMD64, GATEWAY_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\gateway.vmoptions, PSModulePath=C:\Program Files\WindowsPowerShell\Modules;C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules, SystemDrive=C:, MAVEN_HOME=D:\apache-maven-3.8.6, RIDER_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\rider.vmoptions, USERNAME=admin, DEVECOSTUDIO_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\devecostudio.vmoptions, STUDIO_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\studio.vmoptions, ProgramFiles(x86)=C:\Program Files (x86), FPS_BROWSER_USER_PROFILE_STRING=Default, PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC, APPCODE_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\appcode.vmoptions, DriverData=C:\Windows\System32\Drivers\DriverData, IntelliJ IDEA Community Edition=D:\IntelliJ IDEA Community Edition 2023.1.5\bin;, UGIT_HOME=C:\Users\admin\AppData\Local\UGit\app-5.31.1, DATASPELL_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\dataspell.vmoptions, ProgramData=C:\ProgramData, ProgramW6432=C:\Program Files, HOMEPATH=\Users\admin, PROCESSOR_IDENTIFIER=Intel64 Family 6 Model 158 Stepping 10, GenuineIntel, ProgramFiles=C:\Program Files, PUBLIC=C:\Users\Public, windir=C:\WINDOWS, =::=::\, ZES_ENABLE_SYSMAN=1, DATAGRIP_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\datagrip.vmoptions, LOCALAPPDATA=C:\Users\admin\AppData\Local, USERDOMAIN=柯南剧场版, FPS_BROWSER_APP_PROFILE_STRING=Internet Explorer, LOGONSERVER=\\柯南剧场版, PYCHARM_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\pycharm.vmoptions, WEBSTORM_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\webstorm.vmoptions, JAVA_HOME=D:\jdk1.8, CLION_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\clion.vmoptions, JETBRAINSCLIENT_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\jetbrainsclient.vmoptions, WebStorm=D:\WebStorm 2023.2.4\bin;, asl.log=Destination=file, EFC_12948=0, GOLAND_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\goland.vmoptions, OneDrive=C:\Users\admin\OneDrive, APPDATA=C:\Users\admin\AppData\Roaming, IDEA_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\idea.vmoptions, RUBYMINE_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\rubymine.vmoptions, JETBRAINS_CLIENT_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\jetbrains_client.vmoptions, CommonProgramFiles=C:\Program Files\Common Files, Path=C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\WINDOWS\System32\OpenSSH\;D:\jdk1.8\bin;D:\apache-maven-3.8.6\bin;D:\TortoiseGit\bin;C:\Program Files\MySQL\MySQL Server 8.0\bin;C:\Program Files\dotnet\;D:\Git\cmd;C:\Program Files\MySQL\MySQL Shell 8.0\bin\;%USERPROFILE%\AppData\Local\Microsoft\WindowsApps;%IntelliJ IDEA Community Edition%;%WebStorm%;C:\Users\admin\AppData\Local\UGit\app-5.31.1\resources\app\git\cmd;C:\Users\admin\AppData\Local\UGit\bin, OS=Windows_NT, COMPUTERNAME=柯南剧场版, PROCESSOR_REVISION=9e0a, CommonProgramW6432=C:\Program Files\Common Files, ComSpec=C:\WINDOWS\system32\cmd.exe, WXDRIVE_START_ARGS=--wxdrive-setting=0 --disable-gpu --disable-software-rasterizer --enable-features=NetworkServiceInProcess, SystemRoot=C:\WINDOWS, TEMP=C:\Users\admin\AppData\Local\Temp, WEBIDE_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\webide.vmoptions, HOMEDRIVE=C:, USERPROFILE=C:\Users\admin, TMP=C:\Users\admin\AppData\Local\Temp, CommonProgramFiles(x86)=C:\Program Files (x86)\Common Files, NUMBER_OF_PROCESSORS=12, PHPSTORM_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\phpstorm.vmoptions, IDEA_INITIAL_DIRECTORY=C:\Users\admin\Desktop}}]}

systemProperties = {java.runtime.name=Java(TM) SE Runtime Environment, sun.boot.library.path=D:\jdk1.8\jre\bin, java.vm.version=25.202-b08, java.vm.vendor=Oracle Corporation, java.vendor.url=http://java.oracle.com/, path.separator=;, java.vm.name=Java HotSpot(TM) 64-Bit Server VM, file.encoding.pkg=sun.io, user.country=CN, user.script=, sun.java.launcher=SUN_STANDARD, sun.os.patch.level=, java.vm.specification.name=Java Virtual Machine Specification, user.dir=D:\项目\learn-project, intellij.debug.agent=true, java.runtime.version=1.8.0_202-b08, java.awt.graphicsenv=sun.awt.Win32GraphicsEnvironment, java.endorsed.dirs=D:\jdk1.8\jre\lib\endorsed, os.arch=amd64, java.io.tmpdir=C:\Users\admin\AppData\Local\Temp\, line.separator=
, java.vm.specification.vendor=Oracle Corporation, user.variant=, os.name=Windows 10, sun.jnu.encoding=GBK, java.library.path=D:\jdk1.8\bin;C:\WINDOWS\Sun\Java\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\WINDOWS\System32\OpenSSH\;D:\jdk1.8\bin;D:\apache-maven-3.8.6\bin;D:\TortoiseGit\bin;C:\Program Files\MySQL\MySQL Server 8.0\bin;C:\Program Files\dotnet\;D:\Git\cmd;C:\Program Files\MySQL\MySQL Shell 8.0\bin\;%USERPROFILE%\AppData\Local\Microsoft\WindowsApps;%IntelliJ IDEA Community Edition%;%WebStorm%;C:\Users\admin\AppData\Local\UGit\app-5.31.1\resources\app\git\cmd;C:\Users\admin\AppData\Local\UGit\bin;., jboss.modules.system.pkgs=com.intellij.rt, java.specification.name=Java Platform API Specification, java.class.version=52.0, sun.management.compiler=HotSpot 64-Bit Tiered Compilers, os.version=10.0, user.home=C:\Users\admin, user.timezone=Asia/Shanghai, java.awt.printerjob=sun.awt.windows.WPrinterJob, file.encoding=UTF-8, java.specification.version=1.8, java.class.path=D:\jdk1.8\jre\lib\charsets.jar;D:\jdk1.8\jre\lib\deploy.jar;D:\jdk1.8\jre\lib\ext\access-bridge-64.jar;D:\jdk1.8\jre\lib\ext\cldrdata.jar;D:\jdk1.8\jre\lib\ext\dnsns.jar;D:\jdk1.8\jre\lib\ext\jaccess.jar;D:\jdk1.8\jre\lib\ext\jfxrt.jar;D:\jdk1.8\jre\lib\ext\localedata.jar;D:\jdk1.8\jre\lib\ext\nashorn.jar;D:\jdk1.8\jre\lib\ext\sunec.jar;D:\jdk1.8\jre\lib\ext\sunjce_provider.jar;D:\jdk1.8\jre\lib\ext\sunmscapi.jar;D:\jdk1.8\jre\lib\ext\sunpkcs11.jar;D:\jdk1.8\jre\lib\ext\zipfs.jar;D:\jdk1.8\jre\lib\javaws.jar;D:\jdk1.8\jre\lib\jce.jar;D:\jdk1.8\jre\lib\jfr.jar;D:\jdk1.8\jre\lib\jfxswt.jar;D:\jdk1.8\jre\lib\jsse.jar;D:\jdk1.8\jre\lib\management-agent.jar;D:\jdk1.8\jre\lib\plugin.jar;D:\jdk1.8\jre\lib\resources.jar;D:\jdk1.8\jre\lib\rt.jar;D:\项目\learn-project\local-demo\target\classes;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-lang3\3.12.0\commons-lang3-3.12.0.jar;D:\apache-maven-3.8.6\localRepository\commons-io\commons-io\1.3.2\commons-io-1.3.2.jar;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-pool2\2.11.1\commons-pool2-2.11.1.jar;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-math3\3.6.1\commons-math3-3.6.1.jar;D:\apache-maven-3.8.6\localRepository\com\alibaba\fastjson2\fastjson2\2.0.40\fastjson2-2.0.40.jar;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-collections4\4.4\commons-collections4-4.4.jar;D:\apache-maven-3.8.6\localRepository\org\apache\httpcomponents\httpclient\4.5.13\httpclient-4.5.13.jar;D:\apache-maven-3.8.6\localRepository\org\apache\httpcomponents\httpcore\4.4.13\httpcore-4.4.13.jar;D:\apache-maven-3.8.6\localRepository\commons-logging\commons-logging\1.2\commons-logging-1.2.jar;D:\apache-maven-3.8.6\localRepository\commons-codec\commons-codec\1.11\commons-codec-1.11.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-web\2.6.6\spring-boot-starter-web-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter\2.6.6\spring-boot-starter-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot\2.6.6\spring-boot-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-logging\2.6.6\spring-boot-starter-logging-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\ch\qos\logback\logback-classic\1.2.11\logback-classic-1.2.11.jar;D:\apache-maven-3.8.6\localRepository\ch\qos\logback\logback-core\1.2.11\logback-core-1.2.11.jar;D:\apache-maven-3.8.6\localRepository\org\apache\logging\log4j\log4j-to-slf4j\2.17.2\log4j-to-slf4j-2.17.2.jar;D:\apache-maven-3.8.6\localRepository\org\apache\logging\log4j\log4j-api\2.17.2\log4j-api-2.17.2.jar;D:\apache-maven-3.8.6\localRepository\org\slf4j\jul-to-slf4j\1.7.36\jul-to-slf4j-1.7.36.jar;D:\apache-maven-3.8.6\localRepository\jakarta\annotation\jakarta.annotation-api\1.3.5\jakarta.annotation-api-1.3.5.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-core\5.3.18\spring-core-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-jcl\5.3.18\spring-jcl-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\yaml\snakeyaml\1.29\snakeyaml-1.29.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-json\2.6.6\spring-boot-starter-json-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\core\jackson-databind\2.13.2.2\jackson-databind-2.13.2.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\core\jackson-annotations\2.13.2\jackson-annotations-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\core\jackson-core\2.13.2\jackson-core-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\datatype\jackson-datatype-jdk8\2.13.2\jackson-datatype-jdk8-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\datatype\jackson-datatype-jsr310\2.13.2\jackson-datatype-jsr310-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\module\jackson-module-parameter-names\2.13.2\jackson-module-parameter-names-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-tomcat\2.6.6\spring-boot-starter-tomcat-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\apache\tomcat\embed\tomcat-embed-core\9.0.60\tomcat-embed-core-9.0.60.jar;D:\apache-maven-3.8.6\localRepository\org\apache\tomcat\embed\tomcat-embed-el\9.0.60\tomcat-embed-el-9.0.60.jar;D:\apache-maven-3.8.6\localRepository\org\apache\tomcat\embed\tomcat-embed-websocket\9.0.60\tomcat-embed-websocket-9.0.60.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-web\5.3.18\spring-web-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-beans\5.3.18\spring-beans-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-webmvc\5.3.18\spring-webmvc-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-aop\5.3.18\spring-aop-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-context\5.3.18\spring-context-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-expression\5.3.18\spring-expression-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\com\mysql\mysql-connector-j\8.0.33\mysql-connector-j-8.0.33.jar;D:\apache-maven-3.8.6\localRepository\com\google\protobuf\protobuf-java\3.21.9\protobuf-java-3.21.9.jar;D:\apache-maven-3.8.6\localRepository\com\google\guava\guava\25.0-jre\guava-25.0-jre.jar;D:\apache-maven-3.8.6\localRepository\com\google\code\findbugs\jsr305\1.3.9\jsr305-1.3.9.jar;D:\apache-maven-3.8.6\localRepository\org\checkerframework\checker-compat-qual\2.0.0\checker-compat-qual-2.0.0.jar;D:\apache-maven-3.8.6\localRepository\com\google\errorprone\error_prone_annotations\2.1.3\error_prone_annotations-2.1.3.jar;D:\apache-maven-3.8.6\localRepository\com\google\j2objc\j2objc-annotations\1.1\j2objc-annotations-1.1.jar;D:\apache-maven-3.8.6\localRepository\org\codehaus\mojo\animal-sniffer-annotations\1.14\animal-sniffer-annotations-1.14.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-boot-starter\3.5.3.1\mybatis-plus-boot-starter-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus\3.5.3.1\mybatis-plus-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-extension\3.5.3.1\mybatis-plus-extension-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-core\3.5.3.1\mybatis-plus-core-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-annotation\3.5.3.1\mybatis-plus-annotation-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\github\jsqlparser\jsqlparser\4.4\jsqlparser-4.4.jar;D:\apache-maven-3.8.6\localRepository\org\mybatis\mybatis\3.5.10\mybatis-3.5.10.jar;D:\apache-maven-3.8.6\localRepository\org\mybatis\mybatis-spring\2.0.7\mybatis-spring-2.0.7.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-autoconfigure\2.5.3\spring-boot-autoconfigure-2.5.3.jar;D:\apache-maven-3.8.6\localRepository\cn\hutool\hutool-all\5.8.26\hutool-all-5.8.26.jar;D:\apache-maven-3.8.6\localRepository\com\alibaba\druid-spring-boot-starter\1.2.22\druid-spring-boot-starter-1.2.22.jar;D:\apache-maven-3.8.6\localRepository\com\alibaba\druid\1.2.22\druid-1.2.22.jar;D:\apache-maven-3.8.6\localRepository\org\slf4j\slf4j-api\1.7.36\slf4j-api-1.7.36.jar;D:\apache-maven-3.8.6\localRepository\org\glassfish\jaxb\jaxb-runtime\2.3.2\jaxb-runtime-2.3.2.jar;D:\apache-maven-3.8.6\localRepository\jakarta\xml\bind\jakarta.xml.bind-api\2.3.2\jakarta.xml.bind-api-2.3.2.jar;D:\apache-maven-3.8.6\localRepository\org\glassfish\jaxb\txw2\2.3.2\txw2-2.3.2.jar;D:\apache-maven-3.8.6\localRepository\com\sun\istack\istack-commons-runtime\3.0.8\istack-commons-runtime-3.0.8.jar;D:\apache-maven-3.8.6\localRepository\org\jvnet\staxex\stax-ex\1.8.1\stax-ex-1.8.1.jar;D:\apache-maven-3.8.6\localRepository\com\sun\xml\fastinfoset\FastInfoset\1.2.16\FastInfoset-1.2.16.jar;D:\apache-maven-3.8.6\localRepository\jakarta\activation\jakarta.activation-api\1.2.1\jakarta.activation-api-1.2.1.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-starter-openfeign\4.1.0\spring-cloud-starter-openfeign-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-starter\4.1.0\spring-cloud-starter-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-context\4.1.0\spring-cloud-context-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\security\spring-security-rsa\1.1.1\spring-security-rsa-1.1.1.jar;D:\apache-maven-3.8.6\localRepository\org\bouncycastle\bcprov-jdk18on\1.74\bcprov-jdk18on-1.74.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-openfeign-core\4.1.0\spring-cloud-openfeign-core-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-aop\3.2.0\spring-boot-starter-aop-3.2.0.jar;D:\apache-maven-3.8.6\localRepository\org\aspectj\aspectjweaver\1.9.20.1\aspectjweaver-1.9.20.1.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\form\feign-form-spring\3.8.0\feign-form-spring-3.8.0.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\form\feign-form\3.8.0\feign-form-3.8.0.jar;D:\apache-maven-3.8.6\localRepository\commons-fileupload\commons-fileupload\1.5\commons-fileupload-1.5.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-commons\4.1.0\spring-cloud-commons-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\security\spring-security-crypto\6.2.0\spring-security-crypto-6.2.0.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\feign-core\13.1\feign-core-13.1.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\feign-slf4j\13.1\feign-slf4j-13.1.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-jdbc\2.7.9\spring-boot-starter-jdbc-2.7.9.jar;D:\apache-maven-3.8.6\localRepository\com\zaxxer\HikariCP\4.0.3\HikariCP-4.0.3.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-jdbc\5.3.25\spring-jdbc-5.3.25.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-tx\5.3.25\spring-tx-5.3.25.jar;D:\IntelliJ IDEA Community Edition 2023.1.5\lib\idea_rt.jar;C:\Users\admin\AppData\Local\JetBrains\IdeaIC2024.1\captureAgent\debugger-agent.jar, user.name=admin, java.vm.specification.version=1.8, sun.java.command=com.wjs.learn.spring.SpringContextStarter, java.home=D:\jdk1.8\jre, sun.arch.data.model=64, user.language=zh, java.specification.vendor=Oracle Corporation, awt.toolkit=sun.awt.windows.WToolkit, java.vm.info=mixed mode, java.version=1.8.0_202, java.ext.dirs=D:\jdk1.8\jre\lib\ext;C:\WINDOWS\Sun\Java\lib\ext, sun.boot.class.path=D:\jdk1.8\jre\lib\resources.jar;D:\jdk1.8\jre\lib\rt.jar;D:\jdk1.8\jre\lib\sunrsasign.jar;D:\jdk1.8\jre\lib\jsse.jar;D:\jdk1.8\jre\lib\jce.jar;D:\jdk1.8\jre\lib\charsets.jar;D:\jdk1.8\jre\lib\jfr.jar;D:\jdk1.8\jre\classes;C:\Users\admin\AppData\Local\JetBrains\IdeaIC2024.1\captureAgent\debugger-agent.jar, java.vendor=Oracle Corporation, file.separator=\, java.vendor.url.bug=http://bugreport.sun.com/bugreport/, sun.io.unicode.encoding=UnicodeLittle, sun.cpu.endian=little, sun.desktop=windows, sun.cpu.isalist=amd64}

systemEnvironment = {USERDOMAIN_ROAMINGPROFILE=柯南剧场版, PROCESSOR_LEVEL=6, SESSIONNAME=Console, ALLUSERSPROFILE=C:\ProgramData, PROCESSOR_ARCHITECTURE=AMD64, GATEWAY_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\gateway.vmoptions, PSModulePath=C:\Program Files\WindowsPowerShell\Modules;C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules, SystemDrive=C:, MAVEN_HOME=D:\apache-maven-3.8.6, RIDER_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\rider.vmoptions, USERNAME=admin, DEVECOSTUDIO_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\devecostudio.vmoptions, STUDIO_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\studio.vmoptions, ProgramFiles(x86)=C:\Program Files (x86), FPS_BROWSER_USER_PROFILE_STRING=Default, PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC, APPCODE_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\appcode.vmoptions, DriverData=C:\Windows\System32\Drivers\DriverData, IntelliJ IDEA Community Edition=D:\IntelliJ IDEA Community Edition 2023.1.5\bin;, UGIT_HOME=C:\Users\admin\AppData\Local\UGit\app-5.31.1, DATASPELL_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\dataspell.vmoptions, ProgramData=C:\ProgramData, ProgramW6432=C:\Program Files, HOMEPATH=\Users\admin, PROCESSOR_IDENTIFIER=Intel64 Family 6 Model 158 Stepping 10, GenuineIntel, ProgramFiles=C:\Program Files, PUBLIC=C:\Users\Public, windir=C:\WINDOWS, =::=::\, ZES_ENABLE_SYSMAN=1, DATAGRIP_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\datagrip.vmoptions, LOCALAPPDATA=C:\Users\admin\AppData\Local, USERDOMAIN=柯南剧场版, FPS_BROWSER_APP_PROFILE_STRING=Internet Explorer, LOGONSERVER=\\柯南剧场版, PYCHARM_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\pycharm.vmoptions, WEBSTORM_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\webstorm.vmoptions, JAVA_HOME=D:\jdk1.8, CLION_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\clion.vmoptions, JETBRAINSCLIENT_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\jetbrainsclient.vmoptions, WebStorm=D:\WebStorm 2023.2.4\bin;, asl.log=Destination=file, EFC_12948=0, GOLAND_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\goland.vmoptions, OneDrive=C:\Users\admin\OneDrive, APPDATA=C:\Users\admin\AppData\Roaming, IDEA_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\idea.vmoptions, RUBYMINE_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\rubymine.vmoptions, JETBRAINS_CLIENT_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\jetbrains_client.vmoptions, CommonProgramFiles=C:\Program Files\Common Files, Path=C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\WINDOWS\System32\OpenSSH\;D:\jdk1.8\bin;D:\apache-maven-3.8.6\bin;D:\TortoiseGit\bin;C:\Program Files\MySQL\MySQL Server 8.0\bin;C:\Program Files\dotnet\;D:\Git\cmd;C:\Program Files\MySQL\MySQL Shell 8.0\bin\;%USERPROFILE%\AppData\Local\Microsoft\WindowsApps;%IntelliJ IDEA Community Edition%;%WebStorm%;C:\Users\admin\AppData\Local\UGit\app-5.31.1\resources\app\git\cmd;C:\Users\admin\AppData\Local\UGit\bin, OS=Windows_NT, COMPUTERNAME=柯南剧场版, PROCESSOR_REVISION=9e0a, CommonProgramW6432=C:\Program Files\Common Files, ComSpec=C:\WINDOWS\system32\cmd.exe, WXDRIVE_START_ARGS=--wxdrive-setting=0 --disable-gpu --disable-software-rasterizer --enable-features=NetworkServiceInProcess, SystemRoot=C:\WINDOWS, TEMP=C:\Users\admin\AppData\Local\Temp, WEBIDE_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\webide.vmoptions, HOMEDRIVE=C:, USERPROFILE=C:\Users\admin, TMP=C:\Users\admin\AppData\Local\Temp, CommonProgramFiles(x86)=C:\Program Files (x86)\Common Files, NUMBER_OF_PROCESSORS=12, PHPSTORM_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\phpstorm.vmoptions, IDEA_INITIAL_DIRECTORY=C:\Users\admin\Desktop}
```

---

Spring 容器注册 Environment Bean 链路：

```shell
org.springframework.context.annotation.AnnotationConfigApplicationContext#refresh
|
org.springframework.context.support.AbstractApplicationContext#refresh
|
org.springframework.context.support.AbstractApplicationContext#prepareBeanFactory
|
org.springframework.beans.factory.config.SingletonBeanRegistry#registerSingleton
```

---

Spring 容器注册 Environment Bean 链路代码清单：

- 1、org.springframework.context.annotation.AnnotationConfigApplicationContext#refresh

- 2、org.springframework.context.support.AbstractApplicationContext#refresh

```java 
public void refresh() throws BeansException, IllegalStateException {
    synchronized (this.startupShutdownMonitor) {
    
        ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();

        // ConfigurableListableBeanFactory 预处理
        prepareBeanFactory(beanFactory);
    }
}
```

- 3、org.springframework.context.support.AbstractApplicationContext#prepareBeanFactory

```java
// Spring Environment BeanName 
String ENVIRONMENT_BEAN_NAME = "environment";

// JVM 系统属性集合（System.getProperties()） BeanName
String SYSTEM_PROPERTIES_BEAN_NAME = "systemProperties";

// 系统环境变量集合（System.getenv()） BeanName
String SYSTEM_ENVIRONMENT_BEAN_NAME = "systemEnvironment";

protected void prepareBeanFactory(ConfigurableListableBeanFactory beanFactory) {
    
    // 注册 Spring Environment Bean
    if (!beanFactory.containsLocalBean(ENVIRONMENT_BEAN_NAME)) {
        beanFactory.registerSingleton(ENVIRONMENT_BEAN_NAME, getEnvironment());
    }
    
    // 注册 JVM 系统属性集合（System.getProperties()） Bean
    if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {
        beanFactory.registerSingleton(SYSTEM_PROPERTIES_BEAN_NAME, getEnvironment().getSystemProperties());
    }
    
    // 注册 系统环境变量集合（System.getenv()） Bean
    if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {
        beanFactory.registerSingleton(SYSTEM_ENVIRONMENT_BEAN_NAME, getEnvironment().getSystemEnvironment());
    }
}
```

# PropertySource

## PropertySource 定义

Spring 的 Environment 抽象提供了对可配置的属性源层次结构的搜索操作。

Environment 对象在一组 PropertySource 对象上执行搜索。PropertySource 是对任何 key 值对来源的简单抽象，Spring 的 StandardEnvironment 配置了两个 PropertySource 对象。一个代表 JVM 系统属性集合（System.getProperties()），一个代表系统环境变量集合（System.getenv()）。

参考文档：
[PropertySource 抽象定义](https://springdoc.cn/spring/core.html#beans-property-source-abstraction)

## PropertySource 解析

Spring 容器获取 PropertySource，代码示例：

```java 
package com.wjs.learn.spring;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.core.env.ConfigurableEnvironment;
import org.springframework.core.env.MutablePropertySources;
import org.springframework.core.env.PropertySource;

public class SpringContextStarter {
    public static void main(String[] args) {

        // 获取 Spring Environment
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext();
        context.refresh();
        ConfigurableEnvironment environment = context.getEnvironment();

        // 获取 Spring 系统参数配置
        MutablePropertySources propertySources = environment.getPropertySources();
        for (PropertySource<?> propertySource : propertySources) {
            System.out.println("propertySource#getName = " + propertySource.getName());
            System.out.println("propertySource#getSource = " + propertySource.getSource());
        }
    }
}
```

控制台打印：

```shell
propertySource#getName = systemProperties
propertySource#getSource = {java.runtime.name=Java(TM) SE Runtime Environment, sun.boot.library.path=D:\jdk1.8\jre\bin, java.vm.version=25.202-b08, java.vm.vendor=Oracle Corporation, java.vendor.url=http://java.oracle.com/, path.separator=;, java.vm.name=Java HotSpot(TM) 64-Bit Server VM, file.encoding.pkg=sun.io, user.country=CN, user.script=, sun.java.launcher=SUN_STANDARD, sun.os.patch.level=, java.vm.specification.name=Java Virtual Machine Specification, user.dir=D:\项目\learn-project, intellij.debug.agent=true, java.runtime.version=1.8.0_202-b08, java.awt.graphicsenv=sun.awt.Win32GraphicsEnvironment, java.endorsed.dirs=D:\jdk1.8\jre\lib\endorsed, os.arch=amd64, java.io.tmpdir=C:\Users\admin\AppData\Local\Temp\, line.separator=
, java.vm.specification.vendor=Oracle Corporation, user.variant=, os.name=Windows 10, sun.jnu.encoding=GBK, java.library.path=D:\jdk1.8\bin;C:\WINDOWS\Sun\Java\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\WINDOWS\System32\OpenSSH\;D:\jdk1.8\bin;D:\apache-maven-3.8.6\bin;D:\TortoiseGit\bin;C:\Program Files\MySQL\MySQL Server 8.0\bin;C:\Program Files\dotnet\;D:\Git\cmd;C:\Program Files\MySQL\MySQL Shell 8.0\bin\;%USERPROFILE%\AppData\Local\Microsoft\WindowsApps;%IntelliJ IDEA Community Edition%;%WebStorm%;C:\Users\admin\AppData\Local\UGit\app-5.31.1\resources\app\git\cmd;C:\Users\admin\AppData\Local\UGit\bin;., jboss.modules.system.pkgs=com.intellij.rt, java.specification.name=Java Platform API Specification, java.class.version=52.0, sun.management.compiler=HotSpot 64-Bit Tiered Compilers, os.version=10.0, user.home=C:\Users\admin, user.timezone=Asia/Shanghai, java.awt.printerjob=sun.awt.windows.WPrinterJob, file.encoding=UTF-8, java.specification.version=1.8, java.class.path=D:\jdk1.8\jre\lib\charsets.jar;D:\jdk1.8\jre\lib\deploy.jar;D:\jdk1.8\jre\lib\ext\access-bridge-64.jar;D:\jdk1.8\jre\lib\ext\cldrdata.jar;D:\jdk1.8\jre\lib\ext\dnsns.jar;D:\jdk1.8\jre\lib\ext\jaccess.jar;D:\jdk1.8\jre\lib\ext\jfxrt.jar;D:\jdk1.8\jre\lib\ext\localedata.jar;D:\jdk1.8\jre\lib\ext\nashorn.jar;D:\jdk1.8\jre\lib\ext\sunec.jar;D:\jdk1.8\jre\lib\ext\sunjce_provider.jar;D:\jdk1.8\jre\lib\ext\sunmscapi.jar;D:\jdk1.8\jre\lib\ext\sunpkcs11.jar;D:\jdk1.8\jre\lib\ext\zipfs.jar;D:\jdk1.8\jre\lib\javaws.jar;D:\jdk1.8\jre\lib\jce.jar;D:\jdk1.8\jre\lib\jfr.jar;D:\jdk1.8\jre\lib\jfxswt.jar;D:\jdk1.8\jre\lib\jsse.jar;D:\jdk1.8\jre\lib\management-agent.jar;D:\jdk1.8\jre\lib\plugin.jar;D:\jdk1.8\jre\lib\resources.jar;D:\jdk1.8\jre\lib\rt.jar;D:\项目\learn-project\local-demo\target\classes;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-lang3\3.12.0\commons-lang3-3.12.0.jar;D:\apache-maven-3.8.6\localRepository\commons-io\commons-io\1.3.2\commons-io-1.3.2.jar;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-pool2\2.11.1\commons-pool2-2.11.1.jar;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-math3\3.6.1\commons-math3-3.6.1.jar;D:\apache-maven-3.8.6\localRepository\com\alibaba\fastjson2\fastjson2\2.0.40\fastjson2-2.0.40.jar;D:\apache-maven-3.8.6\localRepository\org\apache\commons\commons-collections4\4.4\commons-collections4-4.4.jar;D:\apache-maven-3.8.6\localRepository\org\apache\httpcomponents\httpclient\4.5.13\httpclient-4.5.13.jar;D:\apache-maven-3.8.6\localRepository\org\apache\httpcomponents\httpcore\4.4.13\httpcore-4.4.13.jar;D:\apache-maven-3.8.6\localRepository\commons-logging\commons-logging\1.2\commons-logging-1.2.jar;D:\apache-maven-3.8.6\localRepository\commons-codec\commons-codec\1.11\commons-codec-1.11.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-web\2.6.6\spring-boot-starter-web-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter\2.6.6\spring-boot-starter-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot\2.6.6\spring-boot-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-logging\2.6.6\spring-boot-starter-logging-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\ch\qos\logback\logback-classic\1.2.11\logback-classic-1.2.11.jar;D:\apache-maven-3.8.6\localRepository\ch\qos\logback\logback-core\1.2.11\logback-core-1.2.11.jar;D:\apache-maven-3.8.6\localRepository\org\apache\logging\log4j\log4j-to-slf4j\2.17.2\log4j-to-slf4j-2.17.2.jar;D:\apache-maven-3.8.6\localRepository\org\apache\logging\log4j\log4j-api\2.17.2\log4j-api-2.17.2.jar;D:\apache-maven-3.8.6\localRepository\org\slf4j\jul-to-slf4j\1.7.36\jul-to-slf4j-1.7.36.jar;D:\apache-maven-3.8.6\localRepository\jakarta\annotation\jakarta.annotation-api\1.3.5\jakarta.annotation-api-1.3.5.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-core\5.3.18\spring-core-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-jcl\5.3.18\spring-jcl-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\yaml\snakeyaml\1.29\snakeyaml-1.29.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-json\2.6.6\spring-boot-starter-json-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\core\jackson-databind\2.13.2.2\jackson-databind-2.13.2.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\core\jackson-annotations\2.13.2\jackson-annotations-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\core\jackson-core\2.13.2\jackson-core-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\datatype\jackson-datatype-jdk8\2.13.2\jackson-datatype-jdk8-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\datatype\jackson-datatype-jsr310\2.13.2\jackson-datatype-jsr310-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\com\fasterxml\jackson\module\jackson-module-parameter-names\2.13.2\jackson-module-parameter-names-2.13.2.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-tomcat\2.6.6\spring-boot-starter-tomcat-2.6.6.jar;D:\apache-maven-3.8.6\localRepository\org\apache\tomcat\embed\tomcat-embed-core\9.0.60\tomcat-embed-core-9.0.60.jar;D:\apache-maven-3.8.6\localRepository\org\apache\tomcat\embed\tomcat-embed-el\9.0.60\tomcat-embed-el-9.0.60.jar;D:\apache-maven-3.8.6\localRepository\org\apache\tomcat\embed\tomcat-embed-websocket\9.0.60\tomcat-embed-websocket-9.0.60.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-web\5.3.18\spring-web-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-beans\5.3.18\spring-beans-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-webmvc\5.3.18\spring-webmvc-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-aop\5.3.18\spring-aop-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-context\5.3.18\spring-context-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-expression\5.3.18\spring-expression-5.3.18.jar;D:\apache-maven-3.8.6\localRepository\com\mysql\mysql-connector-j\8.0.33\mysql-connector-j-8.0.33.jar;D:\apache-maven-3.8.6\localRepository\com\google\protobuf\protobuf-java\3.21.9\protobuf-java-3.21.9.jar;D:\apache-maven-3.8.6\localRepository\com\google\guava\guava\25.0-jre\guava-25.0-jre.jar;D:\apache-maven-3.8.6\localRepository\com\google\code\findbugs\jsr305\1.3.9\jsr305-1.3.9.jar;D:\apache-maven-3.8.6\localRepository\org\checkerframework\checker-compat-qual\2.0.0\checker-compat-qual-2.0.0.jar;D:\apache-maven-3.8.6\localRepository\com\google\errorprone\error_prone_annotations\2.1.3\error_prone_annotations-2.1.3.jar;D:\apache-maven-3.8.6\localRepository\com\google\j2objc\j2objc-annotations\1.1\j2objc-annotations-1.1.jar;D:\apache-maven-3.8.6\localRepository\org\codehaus\mojo\animal-sniffer-annotations\1.14\animal-sniffer-annotations-1.14.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-boot-starter\3.5.3.1\mybatis-plus-boot-starter-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus\3.5.3.1\mybatis-plus-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-extension\3.5.3.1\mybatis-plus-extension-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-core\3.5.3.1\mybatis-plus-core-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\baomidou\mybatis-plus-annotation\3.5.3.1\mybatis-plus-annotation-3.5.3.1.jar;D:\apache-maven-3.8.6\localRepository\com\github\jsqlparser\jsqlparser\4.4\jsqlparser-4.4.jar;D:\apache-maven-3.8.6\localRepository\org\mybatis\mybatis\3.5.10\mybatis-3.5.10.jar;D:\apache-maven-3.8.6\localRepository\org\mybatis\mybatis-spring\2.0.7\mybatis-spring-2.0.7.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-autoconfigure\2.5.3\spring-boot-autoconfigure-2.5.3.jar;D:\apache-maven-3.8.6\localRepository\cn\hutool\hutool-all\5.8.26\hutool-all-5.8.26.jar;D:\apache-maven-3.8.6\localRepository\com\alibaba\druid-spring-boot-starter\1.2.22\druid-spring-boot-starter-1.2.22.jar;D:\apache-maven-3.8.6\localRepository\com\alibaba\druid\1.2.22\druid-1.2.22.jar;D:\apache-maven-3.8.6\localRepository\org\slf4j\slf4j-api\1.7.36\slf4j-api-1.7.36.jar;D:\apache-maven-3.8.6\localRepository\org\glassfish\jaxb\jaxb-runtime\2.3.2\jaxb-runtime-2.3.2.jar;D:\apache-maven-3.8.6\localRepository\jakarta\xml\bind\jakarta.xml.bind-api\2.3.2\jakarta.xml.bind-api-2.3.2.jar;D:\apache-maven-3.8.6\localRepository\org\glassfish\jaxb\txw2\2.3.2\txw2-2.3.2.jar;D:\apache-maven-3.8.6\localRepository\com\sun\istack\istack-commons-runtime\3.0.8\istack-commons-runtime-3.0.8.jar;D:\apache-maven-3.8.6\localRepository\org\jvnet\staxex\stax-ex\1.8.1\stax-ex-1.8.1.jar;D:\apache-maven-3.8.6\localRepository\com\sun\xml\fastinfoset\FastInfoset\1.2.16\FastInfoset-1.2.16.jar;D:\apache-maven-3.8.6\localRepository\jakarta\activation\jakarta.activation-api\1.2.1\jakarta.activation-api-1.2.1.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-starter-openfeign\4.1.0\spring-cloud-starter-openfeign-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-starter\4.1.0\spring-cloud-starter-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-context\4.1.0\spring-cloud-context-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\security\spring-security-rsa\1.1.1\spring-security-rsa-1.1.1.jar;D:\apache-maven-3.8.6\localRepository\org\bouncycastle\bcprov-jdk18on\1.74\bcprov-jdk18on-1.74.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-openfeign-core\4.1.0\spring-cloud-openfeign-core-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-aop\3.2.0\spring-boot-starter-aop-3.2.0.jar;D:\apache-maven-3.8.6\localRepository\org\aspectj\aspectjweaver\1.9.20.1\aspectjweaver-1.9.20.1.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\form\feign-form-spring\3.8.0\feign-form-spring-3.8.0.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\form\feign-form\3.8.0\feign-form-3.8.0.jar;D:\apache-maven-3.8.6\localRepository\commons-fileupload\commons-fileupload\1.5\commons-fileupload-1.5.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\cloud\spring-cloud-commons\4.1.0\spring-cloud-commons-4.1.0.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\security\spring-security-crypto\6.2.0\spring-security-crypto-6.2.0.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\feign-core\13.1\feign-core-13.1.jar;D:\apache-maven-3.8.6\localRepository\io\github\openfeign\feign-slf4j\13.1\feign-slf4j-13.1.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\boot\spring-boot-starter-jdbc\2.7.9\spring-boot-starter-jdbc-2.7.9.jar;D:\apache-maven-3.8.6\localRepository\com\zaxxer\HikariCP\4.0.3\HikariCP-4.0.3.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-jdbc\5.3.25\spring-jdbc-5.3.25.jar;D:\apache-maven-3.8.6\localRepository\org\springframework\spring-tx\5.3.25\spring-tx-5.3.25.jar;D:\IntelliJ IDEA Community Edition 2023.1.5\lib\idea_rt.jar;C:\Users\admin\AppData\Local\JetBrains\IdeaIC2024.1\captureAgent\debugger-agent.jar, user.name=admin, java.vm.specification.version=1.8, sun.java.command=com.wjs.learn.spring.SpringContextStarter, java.home=D:\jdk1.8\jre, sun.arch.data.model=64, user.language=zh, java.specification.vendor=Oracle Corporation, awt.toolkit=sun.awt.windows.WToolkit, java.vm.info=mixed mode, java.version=1.8.0_202, java.ext.dirs=D:\jdk1.8\jre\lib\ext;C:\WINDOWS\Sun\Java\lib\ext, sun.boot.class.path=D:\jdk1.8\jre\lib\resources.jar;D:\jdk1.8\jre\lib\rt.jar;D:\jdk1.8\jre\lib\sunrsasign.jar;D:\jdk1.8\jre\lib\jsse.jar;D:\jdk1.8\jre\lib\jce.jar;D:\jdk1.8\jre\lib\charsets.jar;D:\jdk1.8\jre\lib\jfr.jar;D:\jdk1.8\jre\classes;C:\Users\admin\AppData\Local\JetBrains\IdeaIC2024.1\captureAgent\debugger-agent.jar, java.vendor=Oracle Corporation, file.separator=\, java.vendor.url.bug=http://bugreport.sun.com/bugreport/, sun.io.unicode.encoding=UnicodeLittle, sun.cpu.endian=little, sun.desktop=windows, sun.cpu.isalist=amd64}
propertySource#getName = systemEnvironment
propertySource#getSource = {USERDOMAIN_ROAMINGPROFILE=柯南剧场版, PROCESSOR_LEVEL=6, SESSIONNAME=Console, ALLUSERSPROFILE=C:\ProgramData, PROCESSOR_ARCHITECTURE=AMD64, GATEWAY_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\gateway.vmoptions, PSModulePath=C:\Program Files\WindowsPowerShell\Modules;C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules, SystemDrive=C:, MAVEN_HOME=D:\apache-maven-3.8.6, RIDER_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\rider.vmoptions, USERNAME=admin, DEVECOSTUDIO_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\devecostudio.vmoptions, STUDIO_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\studio.vmoptions, ProgramFiles(x86)=C:\Program Files (x86), FPS_BROWSER_USER_PROFILE_STRING=Default, PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC, APPCODE_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\appcode.vmoptions, DriverData=C:\Windows\System32\Drivers\DriverData, IntelliJ IDEA Community Edition=D:\IntelliJ IDEA Community Edition 2023.1.5\bin;, UGIT_HOME=C:\Users\admin\AppData\Local\UGit\app-5.31.1, DATASPELL_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\dataspell.vmoptions, ProgramData=C:\ProgramData, ProgramW6432=C:\Program Files, HOMEPATH=\Users\admin, PROCESSOR_IDENTIFIER=Intel64 Family 6 Model 158 Stepping 10, GenuineIntel, ProgramFiles=C:\Program Files, PUBLIC=C:\Users\Public, windir=C:\WINDOWS, =::=::\, ZES_ENABLE_SYSMAN=1, DATAGRIP_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\datagrip.vmoptions, LOCALAPPDATA=C:\Users\admin\AppData\Local, USERDOMAIN=柯南剧场版, FPS_BROWSER_APP_PROFILE_STRING=Internet Explorer, LOGONSERVER=\\柯南剧场版, PYCHARM_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\pycharm.vmoptions, WEBSTORM_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\webstorm.vmoptions, JAVA_HOME=D:\jdk1.8, CLION_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\clion.vmoptions, JETBRAINSCLIENT_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\jetbrainsclient.vmoptions, WebStorm=D:\WebStorm 2023.2.4\bin;, asl.log=Destination=file, EFC_12948=0, GOLAND_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\goland.vmoptions, OneDrive=C:\Users\admin\OneDrive, APPDATA=C:\Users\admin\AppData\Roaming, IDEA_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\idea.vmoptions, RUBYMINE_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\rubymine.vmoptions, JETBRAINS_CLIENT_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\jetbrains_client.vmoptions, CommonProgramFiles=C:\Program Files\Common Files, Path=C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\WINDOWS\System32\OpenSSH\;D:\jdk1.8\bin;D:\apache-maven-3.8.6\bin;D:\TortoiseGit\bin;C:\Program Files\MySQL\MySQL Server 8.0\bin;C:\Program Files\dotnet\;D:\Git\cmd;C:\Program Files\MySQL\MySQL Shell 8.0\bin\;%USERPROFILE%\AppData\Local\Microsoft\WindowsApps;%IntelliJ IDEA Community Edition%;%WebStorm%;C:\Users\admin\AppData\Local\UGit\app-5.31.1\resources\app\git\cmd;C:\Users\admin\AppData\Local\UGit\bin, OS=Windows_NT, COMPUTERNAME=柯南剧场版, PROCESSOR_REVISION=9e0a, CommonProgramW6432=C:\Program Files\Common Files, ComSpec=C:\WINDOWS\system32\cmd.exe, WXDRIVE_START_ARGS=--wxdrive-setting=0 --disable-gpu --disable-software-rasterizer --enable-features=NetworkServiceInProcess, SystemRoot=C:\WINDOWS, TEMP=C:\Users\admin\AppData\Local\Temp, WEBIDE_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\webide.vmoptions, HOMEDRIVE=C:, USERPROFILE=C:\Users\admin, TMP=C:\Users\admin\AppData\Local\Temp, CommonProgramFiles(x86)=C:\Program Files (x86)\Common Files, NUMBER_OF_PROCESSORS=12, PHPSTORM_VM_OPTIONS=C:\Users\admin\AppData\Roaming\JetBrains\plugins-jetbrains\vmoptions\phpstorm.vmoptions, IDEA_INITIAL_DIRECTORY=C:\Users\admin\Desktop}
```

---

Spring 容器中 PropertySource 清单：

|                                                                      |
|----------------------------------------------------------------------|
| org.springframework.core.env.PropertySources                         |
| org.springframework.core.env.MutablePropertySources                  |
| org.springframework.core.env.PropertySource                          |
| org.springframework.core.env.EnumerablePropertySource                |
| org.springframework.core.env.MapPropertySource                       |
| org.springframework.core.env.SystemEnvironmentPropertySource         |
| org.springframework.core.env.PropertySource.StubPropertySource       |
| org.springframework.core.env.PropertySource.ComparisonPropertySource |
| org.springframework.core.env.CommandLinePropertySource               |
| org.springframework.core.env.SimpleCommandLinePropertySource         |
| org.springframework.core.env.JOptCommandLinePropertySource           |
| org.springframework.core.env.PropertiesPropertySource                |
| org.springframework.core.io.support.ResourcePropertySource           |
| org.springframework.core.env.PropertyResolver                        |
| org.springframework.core.env.ConfigurablePropertyResolver            |
| org.springframework.core.env.AbstractPropertyResolver                |
| org.springframework.core.env.PropertySourcesPropertyResolver         |


---

Spring 容器中 PropertySource 继承关系：

```java 
PropertySource (org.springframework.core.env)
    StubPropertySource in PropertySource (org.springframework.core.env)
        ComparisonPropertySource in PropertySource (org.springframework.core.env)
    EnumerablePropertySource (org.springframework.core.env)
        CompositePropertySource (org.springframework.core.env)
        CommandLinePropertySource (org.springframework.core.env)
            SimpleCommandLinePropertySource (org.springframework.core.env)
            JOptCommandLinePropertySource (org.springframework.core.env)
        MapPropertySource (org.springframework.core.env)
            PropertiesPropertySource (org.springframework.core.env)
                ResourcePropertySource (org.springframework.core.io.support)
            SystemEnvironmentPropertySource (org.springframework.core.env)
    JndiPropertySource (org.springframework.jndi)
```

---

Spring 容器中 PropertySource 初始化链路：

```shell
org.springframework.context.annotation.AnnotationConfigApplicationContext#refresh
|
org.springframework.context.support.AbstractApplicationContext#refresh
|
org.springframework.context.support.AbstractApplicationContext#prepareBeanFactory
|
org.springframework.context.support.AbstractApplicationContext#getEnvironment
|
org.springframework.context.support.AbstractApplicationContext#createEnvironment
|
org.springframework.core.env.StandardEnvironment#StandardEnvironment()
|
org.springframework.core.env.AbstractEnvironment#AbstractEnvironment()
|
org.springframework.core.env.AbstractEnvironment#AbstractEnvironment(org.springframework.core.env.MutablePropertySources)
|
org.springframework.core.env.StandardEnvironment#customizePropertySources
|
1、propertySources.addLast(new PropertiesPropertySource(SYSTEM_PROPERTIES_PROPERTY_SOURCE_NAME, getSystemProperties()));
org.springframework.core.env.PropertiesPropertySource#PropertiesPropertySource(java.lang.String, java.util.Map<java.lang.String,java.lang.Object>)

2、propertySources.addLast(new SystemEnvironmentPropertySource(SYSTEM_ENVIRONMENT_PROPERTY_SOURCE_NAME, getSystemEnvironment()));
org.springframework.core.env.SystemEnvironmentPropertySource#SystemEnvironmentPropertySource
```

---

Spring 容器中 PropertySource 初始化链路代码清单：

- 1、参考 Spring Environment 初始化链路代码清单

- 2、org.springframework.core.env.StandardEnvironment#customizePropertySources

```java 
protected void customizePropertySources(MutablePropertySources propertySources) {
     // JVM 系统属性集合（System.getProperties()）
    propertySources.addLast(new PropertiesPropertySource(SYSTEM_PROPERTIES_PROPERTY_SOURCE_NAME, getSystemProperties()));
    // 系统环境变量集合（System.getenv()）
    propertySources.addLast(new SystemEnvironmentPropertySource(SYSTEM_ENVIRONMENT_PROPERTY_SOURCE_NAME, getSystemEnvironment()));
}
```

- 3、org.springframework.core.env.PropertiesPropertySource#PropertiesPropertySource(java.lang.String, java.util.Map<java.lang.String,java.lang.Object>)

```java 
protected PropertiesPropertySource(String name, Map<String, Object> source) {
    super(name, source);
}
```

- 4、org.springframework.core.env.MapPropertySource#MapPropertySource

```java 
public MapPropertySource(String name, Map<String, Object> source) {
    super(name, source);
}
```

- 5、org.springframework.core.env.EnumerablePropertySource

```java 
public EnumerablePropertySource(String name, T source) {
    super(name, source);
}
```

- 6、org.springframework.core.env.PropertySource#PropertySource(java.lang.String, T)

```java 
public abstract class PropertySource<T> {
	protected final String name;
	protected final T source;

	public PropertySource(String name, T source) {
		this.name = name;
		this.source = source;
	}
}
```

- 7、org.springframework.core.env.SystemEnvironmentPropertySource#SystemEnvironmentPropertySource

```java 
public SystemEnvironmentPropertySource(String name, Map<String, Object> source) {
    super(name, source);
}
``` 

---

Spring 容器中 PropertySources 继承关系：

```java
org.springframework.core.env.PropertySources 
    MutablePropertySources (org.springframework.core.env)
```

---

Spring 容器中 PropertySources 初始化链路：

```shell
org.springframework.context.annotation.AnnotationConfigApplicationContext#refresh
|
org.springframework.context.support.AbstractApplicationContext#refresh
|
org.springframework.context.support.AbstractApplicationContext#prepareBeanFactory
|
org.springframework.context.support.AbstractApplicationContext#getEnvironment
|
org.springframework.context.support.AbstractApplicationContext#createEnvironment
|
org.springframework.core.env.StandardEnvironment#StandardEnvironment()
|
org.springframework.core.env.AbstractEnvironment#AbstractEnvironment()
|
org.springframework.core.env.AbstractEnvironment#AbstractEnvironment(org.springframework.core.env.MutablePropertySources)
|
org.springframework.core.env.AbstractEnvironment#customizePropertySources
```

Spring 容器中 PropertySources 初始化链路代码清单：

- 1、参考 Spring Environment 初始化链路代码清单

- 2、org.springframework.core.env.AbstractEnvironment#AbstractEnvironment()

```java 
public AbstractEnvironment() {
    // 初始化 PropertySources
    this(new MutablePropertySources());
}
```

3、org.springframework.core.env.AbstractEnvironment#AbstractEnvironment(org.springframework.core.env.MutablePropertySources)

```java 
protected AbstractEnvironment(MutablePropertySources propertySources) {
    // 赋值 PropertySources
    this.propertySources = propertySources;
    this.propertyResolver = createPropertyResolver(propertySources);
    
    // PropertySources 填充 PropertySource 配置
    customizePropertySources(propertySources);
}
```

4、org.springframework.core.env.AbstractEnvironment#customizePropertySources

```java
// PropertySources 填充 PropertySource 配置
protected void customizePropertySources(MutablePropertySources propertySources) {
    // JVM 系统属性集合（System.getProperties()）
    propertySources.addLast(new PropertiesPropertySource(SYSTEM_PROPERTIES_PROPERTY_SOURCE_NAME, getSystemProperties()));
    // 系统环境变量集合（System.getenv()）
    propertySources.addLast(new SystemEnvironmentPropertySource(SYSTEM_ENVIRONMENT_PROPERTY_SOURCE_NAME, getSystemEnvironment()));
}
```

---

Spring 容器中 PropertyResolver 继承关系：

```java
org.springframework.core.env.PropertyResolver 
    Environment (org.springframework.core.env)
        ConfigurableEnvironment (org.springframework.core.env)
            AbstractEnvironment (org.springframework.core.env)
                StandardEnvironment (org.springframework.core.env)
    ConfigurablePropertyResolver (org.springframework.core.env)
        ConfigurableEnvironment (org.springframework.core.env)
            AbstractEnvironment (org.springframework.core.env)
                StandardEnvironment (org.springframework.core.env)
        AbstractPropertyResolver (org.springframework.core.env)
            PropertySourcesPropertyResolver (org.springframework.core.env)
```

---

Spring 容器中 PropertyResolver 初始化链路：

```shell
org.springframework.context.annotation.AnnotationConfigApplicationContext#refresh
|
org.springframework.context.support.AbstractApplicationContext#refresh
|
org.springframework.context.support.AbstractApplicationContext#prepareBeanFactory
|
org.springframework.context.support.AbstractApplicationContext#getEnvironment
|
org.springframework.context.support.AbstractApplicationContext#createEnvironment
|
org.springframework.core.env.StandardEnvironment#StandardEnvironment()
|
org.springframework.core.env.AbstractEnvironment#AbstractEnvironment()
|
org.springframework.core.env.AbstractEnvironment#AbstractEnvironment(org.springframework.core.env.MutablePropertySources)
|
org.springframework.core.env.AbstractEnvironment#createPropertyResolver
|
org.springframework.core.env.PropertySourcesPropertyResolver#PropertySourcesPropertyResolver
```

---

Spring 容器中 PropertyResolver 初始化链路清单：

- 1、参考 Spring Environment 初始化链路代码清单

- 2、org.springframework.core.env.AbstractEnvironment#AbstractEnvironment(org.springframework.core.env.MutablePropertySources)

```java 
protected AbstractEnvironment(MutablePropertySources propertySources) {
    this.propertySources = propertySources;
    // PropertyResolver 初始化
    this.propertyResolver = createPropertyResolver(propertySources);
    customizePropertySources(propertySources);
}
```

- 3、org.springframework.core.env.AbstractEnvironment#createPropertyResolver

```java 
protected ConfigurablePropertyResolver createPropertyResolver(MutablePropertySources propertySources) {
    // PropertyResolver 初始化
    return new PropertySourcesPropertyResolver(propertySources);
}
```

- 4、org.springframework.core.env.PropertySourcesPropertyResolver#PropertySourcesPropertyResolver

```java 
public PropertySourcesPropertyResolver(@Nullable PropertySources propertySources) {
    this.propertySources = propertySources;
}
``` 

---

Spring 容器中 PropertyResolver 获取 PropertySource 配置，链路：

```shell
org.springframework.core.env.PropertySourcesPropertyResolver#getProperty(java.lang.String)
|
org.springframework.core.env.PropertySourcesPropertyResolver#getProperty(java.lang.String, java.lang.Class<T>, boolean)
|
org.springframework.core.env.PropertySource#getProperty
|
org.springframework.core.env.MapPropertySource#getProperty
|
org.springframework.core.env.PropertySource#source#get
|
java.util.Map#get
```

---

Spring 容器中 PropertyResolver 获取 PropertySource 配置，链路代码清单：

- 1、org.springframework.core.env.PropertySourcesPropertyResolver#getProperty(java.lang.String)

```java
public String getProperty(String key) {
    return getProperty(key, String.class, true);
}
```

- 2、org.springframework.core.env.PropertySourcesPropertyResolver#getProperty(java.lang.String, java.lang.Class<T>, boolean)

```java
@Nullable
private final PropertySources propertySources;

protected <T> T getProperty(String key, Class<T> targetValueType, boolean resolveNestedPlaceholders) {

    if (this.propertySources != null) {
        // 遍历 PropertySources
        for (PropertySource<?> propertySource : this.propertySources) {
            
            // 获取 PropertySources 配置
            Object value = propertySource.getProperty(key);
            if (value != null) {
                if (resolveNestedPlaceholders && value instanceof String) {
                    value = resolveNestedPlaceholders((String) value);
                }
                logKeyFound(key, propertySource, value);
                return convertValueIfNecessary(value, targetValueType);
            }
        }
    }

    return null;
}
```

- 3、org.springframework.core.env.PropertySource#getProperty

- 4、org.springframework.core.env.MapPropertySource#getProperty

```java
public class MapPropertySource extends EnumerablePropertySource<Map<String, Object>> {
    protected final T source;
    
    public Object getProperty(String name) {
        // java.util.Map#get
        return this.source.get(name);
    }
}
```

## 自定义 PropertySource 属性源

### 实现接口 PropertySource 

自定义 PropertySource 属性源，添加到 Spring 当前环境的 PropertySources 集合中。

自定义 PropertySource 属性源，代码示例：

- 1、自定义 PropertySource 属性源

```java 
package com.wjs.learn.spring.environment;
import org.springframework.core.env.*;
import java.util.Map;

/**
 * 自定义 PropertySource 属性源
 *
 * @author admin
 * @see org.springframework.core.env.PropertySource
 * @see MapPropertySource
 * @see EnumerablePropertySource
 * @see SystemEnvironmentPropertySource
 * @see AbstractEnvironment
 * @see StandardEnvironment
 * @see StandardEnvironment#SYSTEM_ENVIRONMENT_PROPERTY_SOURCE_NAME
 * @see StandardEnvironment#SYSTEM_PROPERTIES_PROPERTY_SOURCE_NAME
 */
public class LearningPropertySource extends PropertySource<Map<String, Object>> {
    public static final String LEARNING_PROPERTY_SOURCE_NAME = "LEARNING_PROPERTY_SOURCE_NAME";

    public LearningPropertySource(String name, Map<String, Object> source) {
        super(name, source);
    }

    public LearningPropertySource(String name) {
        super(name);
    }

    @Override
    public Object getProperty(String name) {
        return this.source.get(name);
    }
}
```

- 2、测试 PropertySource

```java 
package com.wjs.learn.spring;
import com.wjs.learn.spring.environment.LearningPropertySource;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.core.env.ConfigurableEnvironment;
import org.springframework.core.env.MutablePropertySources;
import org.springframework.core.env.PropertySource;
import java.util.Collections;

public class SpringContextStarter {
    public static void main(String[] args) {

        // 获取 Spring Environment
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext();
        ConfigurableEnvironment environment = context.getEnvironment();

        // 自定义 PropertySource 属性源
        LearningPropertySource learningPropertySource = new LearningPropertySource(
                LearningPropertySource.LEARNING_PROPERTY_SOURCE_NAME,
                Collections.singletonMap("package.name", "com.wjs.learn.spring"));

        // 添加到 PropertySources 集合
        environment.getPropertySources().addLast(learningPropertySource);
        context.refresh();

        // 获取 自定义 PropertySource 属性源
        MutablePropertySources propertySources = environment.getPropertySources();
        for (PropertySource<?> propertySource : propertySources) {
            if (LearningPropertySource.LEARNING_PROPERTY_SOURCE_NAME.equals(propertySource.getName())) {
                System.out.println("propertySource#getName = " + propertySource.getName());
                System.out.println("propertySource#getSource = " + propertySource.getSource());
            }
        }
    }
}
```

- 3、控制台打印

```shell
propertySource#getName = LEARNING_PROPERTY_SOURCE_NAME
propertySource#getSource = {package.name=com.wjs.learn.spring}
```

### 声明式注解 @PropertySource 

- 1、自定义 @PropertySource 配置类

```java 
package com.wjs.learn.spring.environment;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;

@Configuration
@PropertySource(name = LearningAnnotationPropertySourceConfiguration.LEARNING_PROPERTY_SOURCE_NAME, value = "environment/propertySource/propertySource.application")
public class LearningAnnotationPropertySourceConfiguration {
    public static final String LEARNING_PROPERTY_SOURCE_NAME = "LEARNING_ANNOTATION_PROPERTY_SOURCE_NAME";
}
```

- 2、自定义 @PropertySource 配置文件

2.1、@PropertySource 配置文件路径：

```shell
src/main/resources/environment/propertySource/propertySource.application
```

2.2、@PropertySource 配置文件

```shell
annotation.package.name=com.wjs.learn.spring.environment
```

- 3、测试

```java 
package com.wjs.learn.spring;
import com.wjs.learn.spring.environment.EnvironmentBeanNameConstant;
import com.wjs.learn.spring.environment.LearningAnnotationPropertySourceConfiguration;
import com.wjs.learn.spring.environment.LearningPropertySource;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.core.env.ConfigurableEnvironment;
import org.springframework.core.env.MutablePropertySources;
import org.springframework.core.env.PropertySource;
import java.util.Collections;
import java.util.Map;

public class SpringContextStarter {
    public static void main(String[] args) {

        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(LearningAnnotationPropertySourceConfiguration.class);
        String property = context.getEnvironment().getProperty("annotation.package.name");
        System.out.println("property = " + property);
    }
}
```

- 4、控制台打印

```shell
property = com.wjs.learn.spring.environment
```

### 声明式注解 @PropertySources

- 1、自定义 @PropertySources 配置类

```java 
package com.wjs.learn.spring.environment;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;
import org.springframework.context.annotation.PropertySources;

@Configuration
@PropertySources(value = {@PropertySource(name = LearningAnnotationPropertySourcesConfiguration.LEARNING_PROPERTY_SOURCE_NAME_1,
                                          value = "environment/propertySource/propertySource_1.application")
                        , @PropertySource(name = LearningAnnotationPropertySourcesConfiguration.LEARNING_PROPERTY_SOURCE_NAME_2,
                                          value = "environment/propertySource/propertySource_2.application")})
public class LearningAnnotationPropertySourcesConfiguration {
    public static final String LEARNING_PROPERTY_SOURCE_NAME_1 = "LEARNING_PROPERTY_SOURCE_NAME_1";
    public static final String LEARNING_PROPERTY_SOURCE_NAME_2 = "LEARNING_PROPERTY_SOURCE_NAME_2";
}
```

- 2、自定义 @PropertySource 配置文件

2.1、@PropertySource 配置文件路径：

```shell
src/main/resources/environment/propertySource/propertySource_1.application
src/main/resources/environment/propertySource/propertySource_2.application
```

2.2、@PropertySource 配置文件：

propertySource_1.application

```shell
annotation.package.name_1=com.wjs.learn.spring.environment_1
```

propertySource_2.application

```shell
annotation.package.name_2=com.wjs.learn.spring.environment_2
```

- 3、测试

```java 
package com.wjs.learn.spring;
import com.wjs.learn.spring.environment.EnvironmentBeanNameConstant;
import com.wjs.learn.spring.environment.LearningAnnotationPropertySourceConfiguration;
import com.wjs.learn.spring.environment.LearningAnnotationPropertySourcesConfiguration;
import com.wjs.learn.spring.environment.LearningPropertySource;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.core.env.ConfigurableEnvironment;
import org.springframework.core.env.MutablePropertySources;
import org.springframework.core.env.PropertySource;
import java.util.Collections;
import java.util.Map;

public class SpringContextStarter {
    public static void main(String[] args) {

        // 获取自定义 PropertySource 源
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(LearningAnnotationPropertySourcesConfiguration.class);
        for (PropertySource<?> propertySource : context.getEnvironment().getPropertySources()) {
            System.out.println("propertySource#getName = " + propertySource.getName());
        }

        // 自定义 PropertySource 源 ——> LEARNING_PROPERTY_SOURCE_NAME_1
        String property_1 = context.getEnvironment().getProperty("annotation.package.name_1");
        System.out.println("property_1 = " + property_1);

        // 自定义 PropertySource 源 ——> LEARNING_PROPERTY_SOURCE_NAME_2
        String property_2 = context.getEnvironment().getProperty("annotation.package.name_2");
        System.out.println("property_2 = " + property_2);
    }
}
```

- 4、控制台打印

```shell
propertySource#getName = systemProperties
propertySource#getName = systemEnvironment
propertySource#getName = LEARNING_PROPERTY_SOURCE_NAME_2
propertySource#getName = LEARNING_PROPERTY_SOURCE_NAME_1
16:07:06.447 [main] DEBUG org.springframework.core.env.PropertySourcesPropertyResolver - Found key 'annotation.package.name_1' in PropertySource 'LEARNING_PROPERTY_SOURCE_NAME_1' with value of type String
property_1 = com.wjs.learn.spring.environment_1
16:07:06.447 [main] DEBUG org.springframework.core.env.PropertySourcesPropertyResolver - Found key 'annotation.package.name_2' in PropertySource 'LEARNING_PROPERTY_SOURCE_NAME_2' with value of type String
property_2 = com.wjs.learn.spring.environment_2
```